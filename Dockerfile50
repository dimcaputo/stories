FROM python:3.11-alpine

COPY requirements.txt ./
COPY templates/ templates/
COPY app.py .

RUN mkdir static
RUN mkdir static/stories
RUN mkdir static/uploads

RUN apk update
RUN apk add build-base
RUN apk add --no-cache py3-pip
RUN apk add curl
RUN pip install -r requirements.txt --verbose
RUN curl -L https://ollama.com/download/ollama-linux-amd64.tgz -o ollama-linux-amd64.tgz
RUN tar -C /usr -xzf ollama-linux-amd64.tgz
RUN echo 
RUN ollama serve
RUN ollama pull qwen2.5vl:3b

EXPOSE 5000

# CMD ["/bin/sh"]
CMD ["python", "app.py"]



